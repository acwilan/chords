---
import App from '../../layouts/App.astro';
import { getCollection } from 'astro:content';

const songs = await getCollection('songs');
songs.sort((a, b) => a.data.title.localeCompare(b.data.title));
const base = import.meta.env.BASE_URL.endsWith('/')
  ? import.meta.env.BASE_URL
  : `${import.meta.env.BASE_URL}/`;
---

<App>
  <Fragment slot="head">
    <title>Songs</title>
  </Fragment>
  <h1>Songs</h1>
  <ul class="grid list-none gap-4 p-0 sm:grid-cols-2 lg:grid-cols-3">
    {songs.map((song) => (
      <li class="list-none">
        <a
          href={`${base}songs/${song.slug}/`}
          class="block rounded border border-gray-200 bg-white p-4 transition hover:bg-gray-50 hover:shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 dark:border-gray-700 dark:bg-gray-800 dark:hover:bg-gray-700/50"
        >
          <h2 class="text-lg font-semibold">{song.data.title}</h2>
          {song.data.key && (
            <p class="text-sm text-gray-600 dark:text-gray-400">Key: {song.data.key}</p>
          )}
          {song.data.tags && (
            <ul class="mt-2 flex flex-wrap gap-1 list-none p-0">
              {song.data.tags.map((tag) => (
                <li class="rounded bg-gray-200 px-2 py-0.5 text-xs text-gray-700 dark:bg-gray-700 dark:text-gray-200">
                  {tag}
                </li>
              ))}
            </ul>
          )}
        </a>
      </li>
    ))}
  </ul>
  <p class="mt-8"><a href={base}>Go back</a></p>
</App>
